INFO:root:ARGS: {'datadir': 'tests/processed_data/sparse_mini', 'modeldir': 'tests/models', 'outdir': 'tests/results', 'resname': 'dplosstest', 'norm': False, 'batchsize': '10', 'batchlength': '128', 'numembed': '1024', 'embeddim': '36', 'lossfunc': 'mse', 'quant': True, 'loglevel': 'INFO', 'sparse': True}
INFO:root:Model will be saved to: tests/models/model_dplosstest-2022-03-28-0.pt
INFO:root:Device: cpu
INFO:root:NEW MAX BATCH SIZE: 9502720
INFO:root:MIDI VECTOR QUANTIZER FORWARD PASS
INFO:root:tensor([[[ 1.2766e-04,  5.2204e-04, -6.2782e-04,  ...,  1.2631e-05,
           6.9973e-05,  4.8743e-04],
         [-4.0663e-04, -6.4401e-04, -8.5787e-04,  ...,  5.2204e-04,
          -6.2782e-04, -3.1260e-04],
         [-7.6668e-04, -2.7552e-04, -9.0707e-04,  ..., -6.4401e-04,
          -8.5787e-04, -6.9979e-04],
         ...,
         [-9.5241e-04,  5.2579e-04,  9.6041e-04,  ...,  5.1848e-04,
          -8.8067e-04, -3.1994e-04],
         [-7.9623e-04, -8.3279e-04,  7.8529e-04,  ...,  5.2579e-04,
           9.6041e-04, -7.1600e-04],
         [-7.6643e-04,  1.2631e-05,  6.9973e-05,  ..., -8.3279e-04,
           7.8529e-04, -7.6371e-04]],

        [[ 6.9298e-04,  7.6964e-04, -5.0359e-04,  ...,  1.2631e-05,
           6.9973e-05,  4.8743e-04],
         [-4.0663e-04, -6.4401e-04, -8.5787e-04,  ..., -9.4026e-04,
          -8.4459e-04, -7.7634e-04],
         [ 3.3918e-04, -4.3339e-04, -6.4473e-04,  ..., -6.4401e-04,
          -8.5787e-04, -6.9979e-04],
         ...,
         [-9.5241e-04,  5.2579e-04,  9.6041e-04,  ...,  5.1848e-04,
          -8.8067e-04, -3.1994e-04],
         [-7.9623e-04, -8.3279e-04,  7.8529e-04,  ...,  5.2579e-04,
           9.6041e-04, -7.1600e-04],
         [-7.6643e-04,  1.2631e-05,  6.9973e-05,  ..., -8.3279e-04,
           7.8529e-04, -7.6371e-04]],

        [[ 1.2766e-04,  5.2204e-04, -6.2782e-04,  ...,  1.2631e-05,
           6.9973e-05,  4.8743e-04],
         [-4.0663e-04, -6.4401e-04, -8.5787e-04,  ...,  5.2204e-04,
          -6.2782e-04, -3.1260e-04],
         [-7.6668e-04, -2.7552e-04, -9.0707e-04,  ..., -6.4401e-04,
          -8.5787e-04, -6.9979e-04],
         ...,
         [-9.5241e-04,  5.2579e-04,  9.6041e-04,  ...,  5.1848e-04,
          -8.8067e-04, -3.1994e-04],
         [-7.9623e-04, -8.3279e-04,  7.8529e-04,  ...,  5.2579e-04,
           9.6041e-04, -7.1600e-04],
         [-7.6643e-04,  1.2631e-05,  6.9973e-05,  ..., -8.3279e-04,
           7.8529e-04, -7.6371e-04]],

        ...,

        [[ 1.2766e-04,  5.2204e-04, -6.2782e-04,  ...,  1.2631e-05,
           6.9973e-05,  4.8743e-04],
         [-4.0663e-04, -6.4401e-04, -8.5787e-04,  ...,  5.2204e-04,
          -6.2782e-04, -3.1260e-04],
         [-7.6668e-04, -2.7552e-04, -9.0707e-04,  ..., -6.4401e-04,
          -8.5787e-04, -6.9979e-04],
         ...,
         [-9.5241e-04,  5.2579e-04,  9.6041e-04,  ...,  5.1848e-04,
          -8.8067e-04, -3.1994e-04],
         [-7.9623e-04, -8.3279e-04,  7.8529e-04,  ...,  5.2579e-04,
           9.6041e-04, -7.1600e-04],
         [-7.6643e-04,  1.2631e-05,  6.9973e-05,  ..., -8.3279e-04,
           7.8529e-04, -7.6371e-04]],

        [[ 1.2766e-04,  5.2204e-04, -6.2782e-04,  ...,  1.2631e-05,
           6.9973e-05,  4.8743e-04],
         [-4.0663e-04, -6.4401e-04, -8.5787e-04,  ...,  5.2204e-04,
          -6.2782e-04, -3.1260e-04],
         [-7.6668e-04, -2.7552e-04, -9.0707e-04,  ..., -6.4401e-04,
          -8.5787e-04, -6.9979e-04],
         ...,
         [-9.5241e-04,  5.2579e-04,  9.6041e-04,  ...,  5.1848e-04,
          -8.8067e-04, -3.1994e-04],
         [-7.9623e-04, -8.3279e-04,  7.8529e-04,  ...,  5.2579e-04,
           9.6041e-04, -7.1600e-04],
         [-7.6643e-04,  1.2631e-05,  6.9973e-05,  ..., -8.3279e-04,
           7.8529e-04, -7.6371e-04]],

        [[ 1.2766e-04,  5.2204e-04, -6.2782e-04,  ...,  1.2631e-05,
           6.9973e-05,  4.8743e-04],
         [-4.0663e-04, -6.4401e-04, -8.5787e-04,  ...,  5.2204e-04,
          -6.2782e-04, -3.1260e-04],
         [-7.6668e-04, -2.7552e-04, -9.0707e-04,  ..., -6.4401e-04,
          -8.5787e-04, -6.9979e-04],
         ...,
         [-9.5241e-04,  5.2579e-04,  9.6041e-04,  ...,  5.1848e-04,
          -8.8067e-04, -3.1994e-04],
         [-7.9623e-04, -8.3279e-04,  7.8529e-04,  ...,  5.2579e-04,
           9.6041e-04, -7.1600e-04],
         [-7.6643e-04,  1.2631e-05,  6.9973e-05,  ..., -8.3279e-04,
           7.8529e-04, -7.6371e-04]]], grad_fn=<ViewBackward0>)torch.Size([580, 27, 128])
INFO:root:NEW MAX BATCH SIZE: 14008320
INFO:root:MIDI VECTOR QUANTIZER FORWARD PASS
INFO:root:tensor([[[-8.7233e-04, -4.7795e-04, -1.6278e-03,  ..., -9.8736e-04,
          -9.3002e-04, -5.1256e-04],
         [-1.4066e-03, -1.6440e-03, -1.8579e-03,  ..., -4.7795e-04,
          -1.6278e-03, -1.3126e-03],
         [-1.7667e-03, -1.2755e-03, -1.9071e-03,  ..., -1.6440e-03,
          -1.8579e-03, -1.6998e-03],
         ...,
         [-1.9524e-03, -4.7420e-04, -3.9581e-05,  ..., -4.8152e-04,
          -1.8807e-03, -1.3199e-03],
         [-1.7962e-03, -1.8328e-03, -2.1470e-04,  ..., -4.7420e-04,
          -3.9581e-05, -1.7160e-03],
         [-1.7664e-03, -9.8736e-04, -9.3002e-04,  ..., -1.8328e-03,
          -2.1470e-04, -1.7637e-03]],

        [[-8.7233e-04, -4.7795e-04, -1.6278e-03,  ..., -9.8736e-04,
          -9.3002e-04, -5.1256e-04],
         [-1.4066e-03, -1.6440e-03, -1.8579e-03,  ..., -4.7795e-04,
          -1.6278e-03, -1.3126e-03],
         [-1.7667e-03, -1.2755e-03, -1.9071e-03,  ..., -1.6440e-03,
          -1.8579e-03, -1.6998e-03],
         ...,
         [-1.9524e-03, -4.7420e-04, -3.9581e-05,  ..., -4.8152e-04,
          -1.8807e-03, -1.3199e-03],
         [-1.7962e-03, -1.8328e-03, -2.1470e-04,  ..., -4.7420e-04,
          -3.9581e-05, -1.7160e-03],
         [-1.7664e-03, -9.8736e-04, -9.3002e-04,  ..., -1.8328e-03,
          -2.1470e-04, -1.7637e-03]],

        [[-8.7233e-04, -4.7795e-04, -1.6278e-03,  ..., -9.8736e-04,
          -9.3002e-04, -5.1256e-04],
         [-1.4066e-03, -1.6440e-03, -1.8579e-03,  ..., -4.7795e-04,
          -1.6278e-03, -1.3126e-03],
         [-1.7667e-03, -1.2755e-03, -1.9071e-03,  ..., -1.6440e-03,
          -1.8579e-03, -1.6998e-03],
         ...,
         [-1.9524e-03, -4.7420e-04, -3.9581e-05,  ..., -4.8152e-04,
          -1.8807e-03, -1.3199e-03],
         [-1.7962e-03, -1.8328e-03, -2.1470e-04,  ..., -4.7420e-04,
          -3.9581e-05, -1.7160e-03],
         [-1.7664e-03, -9.8736e-04, -9.3002e-04,  ..., -1.8328e-03,
          -2.1470e-04, -1.7637e-03]],

        ...,

        [[-8.7233e-04, -4.7795e-04, -1.6278e-03,  ..., -9.8736e-04,
          -9.3002e-04, -5.1256e-04],
         [-1.4066e-03, -1.6440e-03, -1.8579e-03,  ..., -4.7795e-04,
          -1.6278e-03, -1.3126e-03],
         [-1.7667e-03, -1.2755e-03, -1.9071e-03,  ..., -1.6440e-03,
          -1.8579e-03, -1.6998e-03],
         ...,
         [-1.9524e-03, -4.7420e-04, -3.9581e-05,  ..., -4.8152e-04,
          -1.8807e-03, -1.3199e-03],
         [-1.7962e-03, -1.8328e-03, -2.1470e-04,  ..., -4.7420e-04,
          -3.9581e-05, -1.7160e-03],
         [-1.7664e-03, -9.8736e-04, -9.3002e-04,  ..., -1.8328e-03,
          -2.1470e-04, -1.7637e-03]],

        [[-8.7233e-04, -4.7795e-04, -1.6278e-03,  ..., -9.8736e-04,
          -9.3002e-04, -5.1256e-04],
         [-1.4066e-03, -1.6440e-03, -1.8579e-03,  ..., -4.7795e-04,
          -1.6278e-03, -1.3126e-03],
         [-1.7667e-03, -1.2755e-03, -1.9071e-03,  ..., -1.6440e-03,
          -1.8579e-03, -1.6998e-03],
         ...,
         [-1.9524e-03, -4.7420e-04, -3.9581e-05,  ..., -4.8152e-04,
          -1.8807e-03, -1.3199e-03],
         [-1.7962e-03, -1.8328e-03, -2.1470e-04,  ..., -4.7420e-04,
          -3.9581e-05, -1.7160e-03],
         [-1.7664e-03, -9.8736e-04, -9.3002e-04,  ..., -1.8328e-03,
          -2.1470e-04, -1.7637e-03]],

        [[-8.7233e-04, -4.7795e-04, -1.6278e-03,  ..., -9.8736e-04,
          -9.3002e-04, -5.1256e-04],
         [-1.4066e-03, -1.6440e-03, -1.8579e-03,  ..., -4.7795e-04,
          -1.6278e-03, -1.3126e-03],
         [-1.7667e-03, -1.2755e-03, -1.9071e-03,  ..., -1.6440e-03,
          -1.8579e-03, -1.6998e-03],
         ...,
         [-1.9524e-03, -4.7420e-04, -3.9581e-05,  ..., -1.6042e-03,
          -1.0726e-03, -1.5584e-03],
         [-1.1030e-03, -1.1734e-03, -1.5015e-03,  ..., -4.7420e-04,
          -3.9581e-05, -1.7160e-03],
         [-1.7664e-03, -9.8736e-04, -9.3002e-04,  ..., -1.1734e-03,
          -1.5015e-03, -1.8302e-03]]], grad_fn=<ViewBackward0>)torch.Size([855, 27, 128])
INFO:root:MIDI VECTOR QUANTIZER FORWARD PASS
INFO:root:tensor([[[-0.0019, -0.0015, -0.0026,  ..., -0.0020, -0.0019, -0.0015],
         [-0.0024, -0.0026, -0.0029,  ..., -0.0015, -0.0026, -0.0023],
         [-0.0028, -0.0023, -0.0029,  ..., -0.0026, -0.0029, -0.0027],
         ...,
         [-0.0029, -0.0015, -0.0010,  ..., -0.0015, -0.0029, -0.0023],
         [-0.0028, -0.0028, -0.0012,  ..., -0.0015, -0.0010, -0.0027],
         [-0.0028, -0.0020, -0.0019,  ..., -0.0028, -0.0012, -0.0028]],

        [[-0.0019, -0.0015, -0.0026,  ..., -0.0020, -0.0019, -0.0015],
         [-0.0024, -0.0026, -0.0029,  ..., -0.0015, -0.0026, -0.0023],
         [-0.0028, -0.0023, -0.0029,  ..., -0.0026, -0.0029, -0.0027],
         ...,
         [-0.0029, -0.0015, -0.0010,  ..., -0.0015, -0.0029, -0.0023],
         [-0.0028, -0.0028, -0.0012,  ..., -0.0015, -0.0010, -0.0027],
         [-0.0028, -0.0020, -0.0019,  ..., -0.0028, -0.0012, -0.0028]],

        [[-0.0019, -0.0015, -0.0026,  ..., -0.0020, -0.0019, -0.0015],
         [-0.0024, -0.0026, -0.0029,  ..., -0.0015, -0.0026, -0.0023],
         [-0.0028, -0.0023, -0.0029,  ..., -0.0026, -0.0029, -0.0027],
         ...,
         [-0.0029, -0.0015, -0.0010,  ..., -0.0015, -0.0029, -0.0023],
         [-0.0028, -0.0028, -0.0012,  ..., -0.0015, -0.0010, -0.0027],
         [-0.0028, -0.0020, -0.0019,  ..., -0.0028, -0.0012, -0.0028]],

        ...,

        [[-0.0019, -0.0015, -0.0026,  ..., -0.0016, -0.0015, -0.0025],
         [-0.0023,  0.0005,  0.0006,  ..., -0.0015, -0.0026, -0.0023],
         [-0.0028, -0.0023, -0.0029,  ..., -0.0014, -0.0015, -0.0023],
         ...,
         [-0.0024, -0.0023, -0.0029,  ..., -0.0018, -0.0014, -0.0022],
         [-0.0014, -0.0019, -0.0023,  ..., -0.0022, -0.0016, -0.0026],
         [-0.0027, -0.0018, -0.0013,  ..., -0.0021, -0.0021, -0.0028]],

        [[-0.0019, -0.0015, -0.0026,  ..., -0.0020, -0.0019, -0.0015],
         [-0.0024, -0.0026, -0.0029,  ..., -0.0015, -0.0026, -0.0023],
         [-0.0028, -0.0023, -0.0029,  ..., -0.0026, -0.0029, -0.0027],
         ...,
         [-0.0029, -0.0015, -0.0010,  ..., -0.0015, -0.0029, -0.0023],
         [-0.0028, -0.0028, -0.0012,  ..., -0.0015, -0.0010, -0.0027],
         [-0.0028, -0.0020, -0.0019,  ..., -0.0028, -0.0012, -0.0028]],

        [[-0.0019, -0.0015, -0.0026,  ..., -0.0020, -0.0019, -0.0015],
         [-0.0024, -0.0026, -0.0029,  ..., -0.0015, -0.0026, -0.0023],
         [-0.0028, -0.0023, -0.0029,  ..., -0.0026, -0.0029, -0.0027],
         ...,
         [-0.0029, -0.0015, -0.0010,  ..., -0.0015, -0.0029, -0.0023],
         [-0.0028, -0.0028, -0.0012,  ..., -0.0015, -0.0010, -0.0027],
         [-0.0028, -0.0020, -0.0019,  ..., -0.0028, -0.0012, -0.0028]]],
       grad_fn=<ViewBackward0>)torch.Size([626, 27, 128])
INFO:root:saving model to tests/models/model_dplosstest-2022-03-28-0.pt
INFO:root:NUM NAN FILES: 0
INFO:root:SAVING FILE TO: tests/results/results_dplosstest-2022-03-28-0.yaml
INFO:root:All done! TOTAL TIME: 46.84363508224487
